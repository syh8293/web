<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>íŒŒìŠ¤ì¹¼ì˜ ì‚¼ê°í˜• & ì´í•­ í™•ì¥ (ì• ë‹ˆë©”ì´ì…˜)</title>
    <style>
        body { font-family: -apple-system, sans-serif; text-align: center; padding: 10px; background: #f8f9fa; margin: 0; }
        
        #triangle-container { 
            overflow-x: auto; 
            padding: 20px 0; 
            white-space: nowrap; 
            -webkit-overflow-scrolling: touch; 
            min-height: 200px; /* ì• ë‹ˆë©”ì´ì…˜ ì¤‘ ë¹ˆ ê³µê°„ ë°©ì§€ */
        }

        .row { display: flex; justify-content: center; min-width: max-content; margin: 3px 0; opacity: 0; transition: opacity 0.5s ease-in-out, background-color 0.5s ease-in-out; }
        .row.show { opacity: 1; } /* ì• ë‹ˆë©”ì´ì…˜ìœ¼ë¡œ ë‚˜íƒ€ë‚  ë•Œ */
        
        .cell { 
            width: 35px; height: 35px; line-height: 35px; 
            margin: 1px; border-radius: 4px; 
            box-shadow: 0 1px 3px rgba(123, 226, 209, 0.1); 
            font-size: 0.8rem; font-weight: bold; 
            background: white; /* ê¸°ë³¸ ë°°ê²½ìƒ‰ */
            color: #333; /* ê¸°ë³¸ ê¸€ììƒ‰ */
        }

        .expansion { 
            margin-top: 20px; font-size: 1rem; color: #007bff; 
            padding: 15px; background: white; border-radius: 10px; 
            display: block; margin-left: 10px; margin-right: 10px;
            word-break: break-all; 
            opacity: 0; transition: opacity 1s ease-in-out; /* ì „ê°œì‹ë„ ì• ë‹ˆë©”ì´ì…˜ */
        }
        .expansion.show { opacity: 1; }

        input, button { 
            font-size: 16px; padding: 10px; margin: 5px; 
            border: 1px solid #ccc; border-radius: 5px; 
            outline: none; /* í¬ì»¤ìŠ¤ ì‹œ ì™¸ê³½ì„  ì œê±° */
        }
        button { 
            background: #28a745; color: white; cursor: pointer; 
            transition: background-color 0.3s ease; 
        }
        button:hover { background-color: #218838; }
        button:disabled { background-color: #cccccc; cursor: not-allowed; } /* ë¹„í™œì„±í™” ìŠ¤íƒ€ì¼ */
    </style>
</head>
<body>

    <h2>ğŸ“ íŒŒìŠ¤ì¹¼ì˜ ì‚¼ê°í˜• & ì´í•­ í™•ì¥ (ì• ë‹ˆë©”ì´ì…˜)</h2>
    <p>ì§€ìˆ˜(n)ë¥¼ ì…ë ¥í•˜ì„¸ìš”: <input type="number" id="level" value="5" min="0" max="15"> 
    <button onclick="animateTriangle()" id="generateButton">ìƒì„±í•˜ê¸°</button></p>

    <div id="triangle-container"></div>
    <div id="expansion-result" class="expansion"></div>

    <script>
        // ê° í–‰ì— ì‚¬ìš©í•  ìƒ‰ìƒ íŒ”ë ˆíŠ¸ (ì›í•˜ëŠ” ìƒ‰ìƒìœ¼ë¡œ ë³€ê²½ ê°€ëŠ¥)
        const colors = [
            '#e6f7ff', '#fff0f6', '#fffbe6', '#e6ffed', '#f6ffed',
            '#f0f5ff', '#faf0ff', '#f0fff0', '#fffafa', '#f5f5dc',
            '#ffefdb', '#ffe6f7', '#e6ffe6', '#fdfdfe', '#f0f8ff'
        ];

        let animationDelay = 300; // ê° í–‰ì´ ë‚˜íƒ€ë‚˜ëŠ” ë”œë ˆì´ (ms)
        let currentAnimationTimeout; // í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ ì• ë‹ˆë©”ì´ì…˜ íƒ€ì„ì•„ì›ƒ ID

        function animateTriangle() {
            // ê¸°ì¡´ ì• ë‹ˆë©”ì´ì…˜ ì¤‘ë‹¨
            if (currentAnimationTimeout) {
                clearTimeout(currentAnimationTimeout);
            }

            const n = parseInt(document.getElementById('level').value);
            const container = document.getElementById('triangle-container');
            const expansionDiv = document.getElementById('expansion-result');
            const generateButton = document.getElementById('generateButton');

            container.innerHTML = ''; // ì´ì „ ì‚¼ê°í˜• ì§€ìš°ê¸°
            expansionDiv.innerHTML = '';
            expansionDiv.classList.remove('show');
            generateButton.disabled = true; // ì• ë‹ˆë©”ì´ì…˜ ì¤‘ ë²„íŠ¼ ë¹„í™œì„±í™”

            let triangle = [];
            let rowElements = []; // ê° í–‰ì˜ DOM ìš”ì†Œë¥¼ ì €ì¥

            for (let i = 0; i <= n; i++) {
                const rowDiv = document.createElement('div');
                rowDiv.className = 'row';
                
                let rowData = [];
                for (let j = 0; j <= i; j++) {
                    let val = (j === 0 || j === i) ? 1 : triangle[i-1][j-1] + triangle[i-1][j];
                    rowData.push(val);
                    
                    const cell = document.createElement('div');
                    cell.className = 'cell';
                    cell.innerText = val;
                    rowDiv.appendChild(cell);
                }
                triangle.push(rowData);
                rowElements.push(rowDiv);
                container.appendChild(rowDiv);
            }

            // ê° í–‰ì„ ìˆœì°¨ì ìœ¼ë¡œ ë‚˜íƒ€ë‚˜ê²Œ í•˜ëŠ” ì• ë‹ˆë©”ì´ì…˜
            function showNextRow(index) {
                if (index <= n) {
                    const rowDiv = rowElements[index];
                    rowDiv.classList.add('show'); // íˆ¬ëª…ë„ë¥¼ 1ë¡œ ë³€ê²½
                    rowDiv.style.backgroundColor = colors[index % colors.length]; // ìƒ‰ìƒ ì ìš©
                    
                    currentAnimationTimeout = setTimeout(() => showNextRow(index + 1), animationDelay);
                } else {
                    // ëª¨ë“  í–‰ì´ ë‚˜íƒ€ë‚œ í›„ ì´í•­ ì „ê°œì‹ í‘œì‹œ
                    displayExpansion(n, triangle);
                    generateButton.disabled = false; // ì• ë‹ˆë©”ì´ì…˜ ì™„ë£Œ í›„ ë²„íŠ¼ í™œì„±í™”
                }
            }
            showNextRow(0); // ì²« ë²ˆì§¸ í–‰ë¶€í„° ì‹œì‘
        }

        function displayExpansion(n, triangle) {
            const expansionDiv = document.getElementById('expansion-result');
            let formula = `(a + b)<sup>${n}</sup> = `;
            let terms = [];
            let lastRow = triangle[n];

            if (!lastRow) { // n=0ì¼ ë•Œ lastRowê°€ ì—†ì„ ìˆ˜ ìˆìŒ
                expansionDiv.innerHTML = `(a + b)<sup>0</sup> = 1`;
            } else {
                for (let k = 0; k <= n; k++) {
                    let coeff = lastRow[k];
                    let aPow = n - k;
                    let bPow = k;
                    
                    let term = "";
                    if (coeff !== 1 || (aPow === 0 && bPow === 0)) term += coeff;
                    if (aPow > 0) term += "a" + (aPow > 1 ? `<sup>${aPow}</sup>` : "");
                    if (bPow > 0) term += "b" + (bPow > 1 ? `<sup>${bPow}</sup>` : "");
                    
                    terms.push(term);
                }
                expansionDiv.innerHTML = formula + terms.join(" + ");
            }
            expansionDiv.classList.add('show'); // ì „ê°œì‹ë„ ì• ë‹ˆë©”ì´ì…˜
        }

        // ì´ˆê¸° ì‹¤í–‰
        animateTriangle();
    </script>
</body>
</html>