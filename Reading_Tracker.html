<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>1만 페이지 읽기 기록</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #f7f7f5;
      color: #222;
      max-width: 480px;
      margin: 0 auto;
      padding: 24px;
    }
    h1 {
      font-size: 1.4rem;
      margin-bottom: 0.5rem;
    }
    .sub {
      font-size: 0.9rem;
      color: #666;
      margin-bottom: 1.5rem;
    }
    .card {
      background: white;
      border-radius: 12px;
      padding: 16px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
      margin-bottom: 16px;
    }
    label {
      display: block;
      font-size: 0.85rem;
      margin-bottom: 4px;
    }
    input, textarea {
      width: 100%;
      padding: 8px;
      margin-bottom: 12px;
      border-radius: 6px;
      border: 1px solid #ccc;
      font-size: 0.95rem;
    }
    button {
      width: 100%;
      padding: 10px;
      border: none;
      border-radius: 8px;
      background: #2f6fed;
      color: white;
      font-size: 1rem;
      cursor: pointer;
    }
    .progress {
      height: 12px;
      background: #e5e5e5;
      border-radius: 6px;
      overflow: hidden;
      margin-top: 8px;
    }
    .bar {
      height: 100%;
      background: #2f6fed;
      width: 0%;
    }
    .small {
      font-size: 0.85rem;
      color: #555;
      margin-top: 6px;
    }
  </style>
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#2f6fed" />
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('service-worker.js');
    }
  </script>
</head>
<body>
  <h1>1만 페이지 읽기</h1>
  <div class="sub">숫자로 남기는 조용한 독서의 기록</div>

  <div class="card">
    <label>오늘 날짜</label>
    <input type="date" id="date" />

    <label>책 제목</label>
    <input type="text" id="title" placeholder="선택 사항" />

    <label>오늘 읽기 시작한 페이지</label>
    <input type="number" id="startPage" />

    <label>오늘 읽기 종료한 페이지</label>
    <input type="number" id="endPage" />

    <label>메모</label>
    <textarea id="memo" rows="2" placeholder="짧은 생각"></textarea>

    <button onclick="saveEntry()">기록하기</button>
  </div>

  <div class="card">
    <div id="total">누적 페이지: 0 / 10,000</div>
    <div class="progress">
      <div class="bar" id="bar"></div>
    </div>
    <div class="small" id="message"></div>
  </div>

  <script>
    const TARGET = 10000;

    function loadEntries() {
      return JSON.parse(localStorage.getItem('readingEntries') || '[]');
    }

    function saveEntries(entries) {
      localStorage.setItem('readingEntries', JSON.stringify(entries));
    }

    function saveEntry() {
      const start = Number(document.getElementById('startPage').value);
      const end = Number(document.getElementById('endPage').value);

      const entry = {
        date: document.getElementById('date').value,
        title: document.getElementById('title').value,
        startPage: start,
        endPage: end,
        pages: Math.max(0, end - start + 1),
        memo: document.getElementById('memo').value
      };

      if (!entry.date || !entry.startPage || !entry.endPage) return;

      const entries = loadEntries();
      entries.push(entry);
      saveEntries(entries);

      document.getElementById('startPage').value = '';
      document.getElementById('endPage').value = '';
      document.getElementById('memo').value = '';

      updateProgress();
    }

    function updateProgress() {
      const entries = loadEntries();
      const total = entries.reduce((sum, e) => sum + (e.pages || 0), 0);
      const percent = Math.min((total / TARGET) * 100, 100);

      document.getElementById('total').innerText = `누적 페이지: ${total} / ${TARGET}`;
      document.getElementById('bar').style.width = percent + '%';

      const daily = Math.ceil((TARGET - total) / Math.max(1, 365 - entries.length));
      document.getElementById('message').innerText =
        total >= TARGET
          ? '이미 목적지에 도착했습니다.'
          : `내일은 약 ${daily}페이지면 충분합니다.`;
    }

    updateProgress();
  </script>
</body>
</html>
